define(['nostojs','jquery','catalogAddToCart'],function(nostojs,$){'use strict';var form=$('#nosto_addtocart_form').catalogAddToCart({});var Recobuy={};Recobuy.addProductToCart=function(productId,element,quantity){quantity=quantity||1;var productData={"productId":productId,'skuId':productId};Recobuy.addSkuToCart(productData,element,quantity);};Recobuy.addMultipleProductsToCart=function(products,element){if(Array.isArray(products)){products.forEach(function(productObj){Recobuy.addSkuToCart(productObj,element,1);});}};Recobuy.addSkuToCart=function(product,element,quantity){quantity=quantity||1;if(typeof element==='object'&&element){var slotId=this.resolveContextSlotId(element);if(slotId){nostojs(function(api){api.recommendedProductAddedToCart(product.productId,slotId);});}}
form.find('input[name="product"]').val(product.productId);var productSku=document.createElement("input");productSku.setAttribute("type","hidden");productSku.setAttribute("name",'sku');productSku.setAttribute("value",product.skuId);form.append(productSku);form.find('input[name="qty"]').val(quantity);form.catalogAddToCart('ajaxSubmit',form);};Recobuy.resolveContextSlotId=function(element){var m=20;var n=0;var e=element;while(typeof e.parentElement!=="undefined"&&e.parentElement){++n;e=e.parentElement;if(e.getAttribute('class')==='nosto_element'&&e.getAttribute('id')){return e.getAttribute('id');}
if(n>=m){return false;}}
return false;};return Recobuy;});